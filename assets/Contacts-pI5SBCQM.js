import{d as S,e as h,s as w,j as t,f as A,g as B,h as u,i as O,k as R,l as v,B as f,L,_ as m,r as p,m as T}from"./index-CuxJ71-P.js";import{F as H,a as P,b}from"./formik.esm-cqYOvFa3.js";const V="_filter_label_1jdvu_1",q="_filter_input_1jdvu_6",g={filter_label:V,filter_input:q},G=()=>{const e=S(),n=h(w);function o(a){e(A(a.target.value))}return t.jsx("label",{className:g.filter_label,children:t.jsx("input",{className:g.filter_input,type:"text",value:n,onChange:o,placeholder:"Find contacts by name"})})},J="_overlay_13kij_1",K="_modal_13kij_14",y={overlay:J,modal:K},Q="_form_phonebook_1jtou_1",W="_form_phonebook_light_1jtou_6",Z="_form_add_container_1jtou_12",_={form_phonebook:Q,form_phonebook_light:W,form_add_container:Z},U=({onClose:e,contact:n})=>{const o={name:"",number:""};n?.name?o.name=n?.name:o.name="",n?.number?o.number=n?.number:o.number="";const a=h(B),{data:r}=u(),[c,{isLoading:d}]=O(),[M,{isLoading:E}]=R(),[z,{isLoading:D}]=v(),x=s=>{if(s.name.trim()===""||s.number.trim()==="")return!0},j=async(s,l)=>{if(x(s)){m.error("Fill all fields");return}if(r.some(i=>i?.name.toLowerCase()===s.name.toLowerCase())){m.error(`${s.name} is already in contacts.`);return}try{await c(s)}catch(i){console.log(i)}finally{l.resetForm(),e()}},$=async(s,l)=>{if(n.name===s.name&&n.number===s.number){l.resetForm(),e();return}if(x(s)){m.error("Fill all fields");return}try{await M(n.id,s),await z(n.id),j(s,l)}catch(i){console.log(i)}finally{}};function I(){}return t.jsx(H,{initialValues:o,onSubmit:o.name?$:j,children:t.jsxs(P,{className:a==="light"?_.form_phonebook_light:_.form_phonebook,children:[t.jsxs("div",{className:_.form_add_container,children:[t.jsx("label",{htmlFor:"name",children:"Name"}),t.jsx(b,{type:"text",name:"name",pattern:"['a-zA-Z\\u0400-\\u04ff0-9\\s\\W+\\.]+",title:"Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan"}),t.jsx("label",{htmlFor:"number",children:"Number"}),t.jsx(b,{type:"tel",name:"number",pattern:"\\+?\\d{1,4}?[ .\\-\\s]?\\(?\\d{1,3}?\\)?[ .\\-\\s]?\\d{1,4}[ .\\-\\s]?\\d{1,4}[ .\\-\\s]?\\d{1,9}",maxLength:"19",title:"Phone number must be digits and can contain spaces, dashes, parentheses and can start with +. For example +38(050)-32-74-456"})]}),t.jsx(f,{onClick:I,children:"âœ”"}),(d||E||D)&&t.jsx(L,{})]})})},X=document.querySelector("#modal-root"),N=({onClose:e,contact:n})=>{p.useEffect(()=>{function a(r){r.code==="Escape"&&e()}return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e]);const o=a=>{a.target.nodeName==="DIV"&&e()};return T.createPortal(t.jsx("div",{className:y.overlay,onMouseDown:o,children:t.jsx("div",{className:y.modal,children:t.jsx(U,{onClose:e,contact:n})})}),X)},Y=()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",children:t.jsx("path",{d:"M6 32h20l2-22h-24zM20 4v-4h-8v4h-10v6l2-2h24l2 2v-6h-10zM18 4h-4v-2h4v2z"})}),tt="_contact_info_container_167k1_1",et="_contact_number_167k1_11",C={contact_info_container:tt,contact_number:et},nt=({contact:e})=>{const[n,{isLoading:o}]=v(),[a,r]=p.useState(!1),c=()=>{r(d=>!d)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:C.contact_info_container,onClick:()=>r(!0),title:"Edit Contact",children:[t.jsxs("span",{children:[e.name,":"]}),t.jsx("span",{className:C.contact_number,children:e.number})]}),t.jsx(f,{onClick:()=>n(e.id),children:t.jsx(Y,{})}),a&&t.jsx(N,{onClose:c,contact:e}),o&&t.jsx(L,{})]})},ot="_list_contacts_u28y6_1",at="_item_u28y6_10",k={list_contacts:ot,item:at},st=e=>{const n=h(w),o=[...e].sort((r,c)=>r.name.localeCompare(c.name));if(!n)return o;const a=n.toLowerCase();return o.filter(r=>r.name.toLowerCase().includes(a))},rt=()=>{const{data:e}=u();return t.jsx("ul",{className:k.list_contacts,children:st(e).map(n=>t.jsx("li",{className:k.item,children:e&&t.jsx(nt,{contact:n})},n.id))})},ct="_hidden_76hmy_1",it="_contact_page_container_76hmy_14",lt="_contacts_container_76hmy_34",F={hidden:ct,contact_page_container:it,contacts_container:lt},_t=()=>{const{data:e}=u(),[n,o]=p.useState(!1),a=()=>{o(r=>!r)};return t.jsx(t.Fragment,{children:e&&t.jsxs("div",{className:F.contacts_container,children:[t.jsxs("div",{className:F.contact_page_container,children:[e?.length>0&&t.jsx(G,{}),t.jsx(f,{onClick:()=>o(!0),children:"+"})]}),t.jsx(rt,{}),n&&t.jsx(N,{onClose:a})]})})};export{_t as default};
